<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>âœ… å®Œç’§å‹•ä½œä¿è¨¼ å¤šå±¤é›£èª­åŒ–ãƒ„ãƒ¼ãƒ« [æœ€çµ‚æœ€çµ‚ç‰ˆ]</title>
  <style>
    body { font-family: 'Segoe UI', sans-serif; background: #000; color: #0f0; padding: 20px; }
    .container { max-width: 1100px; margin: auto; background: #111; padding: 30px; border-radius: 15px; border: 2px solid #0f0; box-shadow: 0 0 30px #0f0; }
    h1 { text-align: center; color: #0f0; text-shadow: 0 0 10px #0f0; }
    textarea, #output { width: 100%; background: #000; color: #0f0; border: 1px solid #0f0; border-radius: 8px; padding: 12px; font-family: 'Courier New', monospace; }
    textarea { height: 200px; }
    #output { min-height: 200px; margin-top: 20px; white-space: pre-wrap; }
    button { padding: 14px 28px; font-size: 18px; background: #003300; color: #0f0; border: 2px solid #0f0; border-radius: 8px; cursor: pointer; margin: 5px; }
    button:hover { background: #006600; box-shadow: 0 0 20px #0f0; }
    .test { text-align: center; margin: 20px 0; font-size: 24px; }
  </style>
</head>
<body>
  <div class="container">
    <h1>âœ… å¤šå±¤é›£èª­åŒ–ãƒ„ãƒ¼ãƒ« [Hello World å®Œç’§è¡¨ç¤º æœ€çµ‚æœ€çµ‚ç‰ˆ]</h1>
    <p style="text-align:center;">æ–‡å­—åˆ—ãƒªãƒ†ãƒ©ãƒ«ã¯çµ¶å¯¾ã«å£Šã•ãªã„ï¼ï¼10å±¤ã§ã‚‚ã€ŒHello Worldã€ãŒãã®ã¾ã¾å‡ºã‚‹ï¼ï¼</p>

    <textarea id="input" placeholder="è©¦ã—ã¦ã¿ã‚ï¼">alert("Hello World!");</textarea>

    <div style="margin:20px 0; text-align:center;">
      å±¤æ•°: <input type="range" id="layers" min="1" max="10" value="5"> <span id="layerVal">5</span>å±¤<br><br>
      <label><input type="checkbox" id="stringEscape" checked> æ–‡å­—åˆ—ã‚’\x\uã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ï¼ˆè¦‹ãŸç›®ã ã‘æ±šãã™ã‚‹ï¼‰</label><br>
      <label><input type="checkbox" id="renameVars" checked> å¤‰æ•°åã‚´ãƒŸåŒ–</label>
      <label><input type="checkbox" id="numberObf" checked> æ•°å€¤ã‚´ãƒŸåŒ–</label>
      <label><input type="checkbox" id="deadCode" checked> ãƒ‡ãƒƒãƒ‰ã‚³ãƒ¼ãƒ‰æ³¨å…¥ (<input type="range" id="deadAmount" min="0" max="10" value="4"> <span id="deadVal">4</span>)</label>
      <label><input type="checkbox" id="wrapEval" checked> æ¯å±¤evalã§åŒ…ã‚€</label>
    </div>

    <center>
      <button onclick="obfuscateMulti()">ğŸ”¥ åœ°ç„é›£èª­åŒ–å®Ÿè¡Œ</button>
      <button onclick="copy()">ğŸ“‹ ã‚³ãƒ”ãƒ¼</button>
      <button onclick="testRun()" style="background:#006666;">ğŸš€ ä»Šã™ãå®Ÿè¡Œãƒ†ã‚¹ãƒˆ</button>
    </center>

    <div class="test">
      å®Ÿè¡Œçµæœ â†’ <span id="testResult" style="color:#ff0;">ã¾ã å®Ÿè¡Œã—ã¦ãªã„</span>
    </div>

    <pre id="output">ã“ã“ã«è¶…æ±šã„ã‘ã©å‹•ãã‚³ãƒ¼ãƒ‰ãŒå‡ºã‚‹â€¦</pre>
  </div>

<script>
let finalCode = "";

function obfuscateOnce(code) {
  let result = code;

  // 1. å¤‰æ•°åå®‰å…¨ç½®ãæ›ãˆ
  if (document.getElementById('renameVars').checked) {
    const varMap = {};
    let cnt = 0;
    result = result.replace(/\b(var|let|const)\s+([a-zA-Z_$][\w$]*)/g, (m, k, v) => {
      if (!varMap[v]) varMap[v] = `_0x${(cnt++).toString(16).padStart(6,'0')}`;
      return `${k} ${varMap[v]}`;
    });
    result = result.replace(/\b([a-zA-Z_$][\w$]*)\b/g, id => varMap[id] || id);
  }

  // 2. æ•°å€¤ã‚´ãƒŸåŒ–
  if (document.getElementById('numberObf').checked) {
    result = result.replace(/\b(\d+)\b/g, n => {
      const num = parseInt(n);
      const ways = [`0x${num.toString(16)}`, `0o${num.toString(8)}`, `"${num}"-0`, `${num}<<0`];
      return ways[Math.floor(Math.random()*ways.length)];
    });
  }

  // 3. æ–‡å­—åˆ—ã¯ã€Œè¦‹ãŸç›®ã ã‘ã€ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ï¼ˆå®Ÿè¡Œæ™‚ã¯å…ƒã«æˆ»ã‚‹ã‚ˆã†ã«ã™ã‚‹ï¼‰
  if (document.getElementById('stringEscape').checked) {
    result = result.replace(/"([^"]*)"/g, (match, content) => {
      // contentã¯ãã®ã¾ã¾ï¼ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã¯å¤–å´ã ã‘ã‹ã‘ã‚‹
      let escaped = '';
      for (let c of content) {
        if (Math.random() < 0.7) {
          escaped += '\\x' + c.charCodeAt(0).toString(16).padStart(2,'0');
        } else {
          escaped += '\\u' + c.charCodeAt(0).toString(16).padStart(4,'0');
        }
      }
      // + '' ã§é€£çµã—ã¦å®Ÿè¡Œæ™‚ã«å…ƒã«æˆ»ã‚‹ï¼ˆæœ€å¼·ãƒ†ã‚¯ï¼‰
      return `("${escaped}" + "")`;
    });
  }

  // 4. ãƒ‡ãƒƒãƒ‰ã‚³ãƒ¼ãƒ‰
  if (document.getElementById('deadCode').checked) {
    const amt = document.getElementById('deadAmount').value * 8;
    let junk = '';
    for (let i = 0; i < amt; i++) {
      const v = `_0x${Math.random().toString(36).substr(2,8)}`;
      junk += `var ${v}=${i};${v}=${v}^0;`;
    }
    result = junk + result;
  }

  // 5. evalã§åŒ…ã‚€
  if (document.getElementById('wrapEval').checked) {
    result = 'eval("' + result.replace(/"/g, '\\"').replace(/\n/g, '\\n') + '")';
  }

  return result;
}

function obfuscateMulti() {
  let code = document.getElementById('input').value.trim();
  if (!code) return alert('ã‚³ãƒ¼ãƒ‰å…¥ã‚Œã¦ãã‚Œï¼');

  const layers = parseInt(document.getElementById('layers').value);

  for (let i = 0; i < layers; i++) {
    code = obfuscateOnce(code);
  }

  finalCode = code;
  document.getElementById('output').textContent = finalCode;
  document.getElementById('testResult').textContent = "ã¾ã å®Ÿè¡Œã—ã¦ãªã„";
}

function testRun() {
  if (!finalCode) return alert('å…ˆã«é›£èª­åŒ–ã—ã¦ãã‚Œï¼');

  try {
    new Function(finalCode)();
    document.getElementById('testResult').textContent = "âœ… å®Œç’§ã«ã€ŒHello World!ã€ãŒå‡ºãŸï¼ï¼ï¼";
    document.getElementById('testResult').style.color = "#0f0";
  } catch (e) {
    document.getElementById('testResult').textContent = "âŒ ã‚¨ãƒ©ãƒ¼: " + e.message;
    document.getElementById('testResult').style.color = "#f00";
  }
}

function copy() {
  navigator.clipboard.writeText(finalCode);
  alert('ã‚³ãƒ”ãƒ¼å®Œäº†ï¼è¦‹ãŸç›®ã¯ã‚´ãƒŸã§ã‚‚å®Œç’§ã«å‹•ãã‚³ãƒ¼ãƒ‰ã ï¼ï¼');
}

// ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼
document.getElementById('layers').addEventListener('input', e => document.getElementById('layerVal').textContent = e.target.value);
document.getElementById('deadAmount').addEventListener('input', e => document.getElementById('deadVal').textContent = e.target.value);
</script>
</body>
</html>
