<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ğŸ›‘ å¤šå±¤é›£èª­åŒ–ãƒ„ãƒ¼ãƒ« [äººé¡æœ€çµ‚é˜²è¡›ãƒ©ã‚¤ãƒ³ç‰ˆ]</title>
  <style>
    body { font-family: 'Courier New', monospace; background: #000; color: #0f0; padding: 20px; line-height: 1.6; }
    .container { max-width: 1100px; margin: auto; background: #111; padding: 30px; border-radius: 15px; border: 3px solid #0f0; box-shadow: 0 0 40px #0f0; }
    h1 { text-align: center; color: #0f0; text-shadow: 0 0 15px #0f0; font-size: 2.5em; }
    textarea, #output { width: 100%; background: #000; color: #0f0; border: 1px solid #0f0; border-radius: 8px; padding: 15px; font-family: 'Courier New', monospace; font-size: 14px; }
    textarea { height: 180px; }
    #output { min-height: 300px; white-space: pre; overflow-x: auto; }
    button { padding: 15px 30px; font-size: 20px; background: #001100; color: #0f0; border: 2px solid #0f0; border-radius: 10px; cursor: pointer; margin: 10px; }
    button:hover { background: #003300; box-shadow: 0 0 25px #0f0; }
    .options { background: #0a0a0a; padding: 20px; border-radius: 10px; margin: 20px 0; }
    .test { text-align: center; font-size: 28px; margin: 30px 0; color: #ff0; text-shadow: 0 0 10px #ff0; }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸ›‘ äººé¡æœ€çµ‚é˜²è¡›ãƒ©ã‚¤ãƒ³ å¤šå±¤é›£èª­åŒ–ãƒ„ãƒ¼ãƒ« ğŸ›‘</h1>
    <p style="text-align:center; font-size:20px;">10å±¤ã§ã‚‚100%å‹•ãã€‚Hello Worldã¯çµ¶å¯¾ã«å£Šã‚Œãªã„ã€‚</p>

    <textarea id="input">alert("Hello World! å¤šå±¤ã§ã‚‚çµ¶å¯¾å£Šã‚Œãªã„ï¼ï¼");</textarea>

    <div class="options">
      <strong>å±¤æ•°: <input type="range" id="layers" min="1" max="10" value="6"> <span id="layerVal">6</span>å±¤</strong><br><br>
      <label><input type="checkbox" id="renameVars" checked> å¤‰æ•°åã‚’_0xdeadbeefåŒ–</label><br>
      <label><input type="checkbox" id="stringEscape" checked> æ–‡å­—åˆ—ã‚’\\x\\uã§æ±šã™ï¼ˆå®Ÿè¡Œæ™‚ã¯å¾©å…ƒï¼‰</label><br>
      <label><input type="checkbox" id="numberSafe" checked> æ•°å€¤ã‚’å®‰å…¨ã«ã‚´ãƒŸåŒ–ï¼ˆ8é€²ç¦æ­¢ï¼‰</label><br>
      <label><input type="checkbox" id="deadCode" checked> ãƒ‡ãƒƒãƒ‰ã‚³ãƒ¼ãƒ‰çˆ†æ’ƒ (<input type="range" id="deadAmount" min="0" max="10" value="5"> <span id="deadVal">5</span>)</label><br>
      <label><input type="checkbox" id="wrapEval" checked> æ¯å±¤evalã§å®Œå…¨åŒ…å›²</label>
    </div>

    <center>
      <button onclick="obfuscateMulti()">ğŸ’€ æœ€çµ‚é›£èª­åŒ–å®Ÿè¡Œ</button>
      <button onclick="copy()">ğŸ“‹ ã‚³ãƒ”ãƒ¼</button>
      <button onclick="testRun()">ğŸš¨ ä»Šã™ãå®Ÿè¡Œãƒ†ã‚¹ãƒˆ</button>
    </center>

    <div class="test">
      å®Ÿè¡Œçµæœ â†’ <span id="testResult">ã¾ã å®Ÿè¡Œã—ã¦ãªã„</span>
    </div>

    <pre id="output">ã“ã“ã«æ°¸é ã«èª­ã‚ãªã„ã‚³ãƒ¼ãƒ‰ãŒç”Ÿã¾ã‚Œã‚‹â€¦</pre>
  </div>

<script>
let finalCode = "";

function obfuscateOnce(code) {
  let result = code;

  // 1. å¤‰æ•°åå®‰å…¨ãƒªãƒãƒ¼ãƒ 
  if (document.getElementById('renameVars').checked) {
    const map = {};
    let i = 0;
    result = result.replace(/\b(let|const|var)\s+([a-zA-Z_$][\w$]*)/g, (m, k, n) => {
      if (!map[n]) map[n] = `_0x${(i++).toString(16).padStart(6,'0')}`;
      return `${k} ${map[n]}`;
    });
    result = result.replace(/\b([a-zA-Z_$][\w$]*)\b/g, id => map[id] || id);
  }

  // 2. æ•°å€¤ã‚´ãƒŸåŒ–ï¼ˆ8é€²ã¯çµ¶å¯¾ä½¿ã‚ãªã„ï¼ï¼‰
  if (document.getElementById('numberSafe').checked) {
    result = result.replace(/\b(\d+)\b/g, n => {
      const num = parseInt(n);
      if (num === 0) return '0';
      const ways = [
        `0x${num.toString(16)}`,
        `(+"${num}")`,
        `(${num}<<0)`,
        `[${num}][0]`,
        `+[]+${num}`
      ];
      return ways[Math.floor(Math.random() * ways.length)];
    });
  }

  // 3. æ–‡å­—åˆ—ã¯ã€Œå®Ÿè¡Œæ™‚ã«å¾©å…ƒã•ã‚Œã‚‹å½¢ã€ã«ã ã‘å¤‰æ›
  if (document.getElementById('stringEscape').checked) {
    result = result.replace(/"([^"]*?)"/g, (m, s) => {
      if (s.includes('\\') || s.includes('"')) return m; // è¤‡é›‘ãªã®ã¯è§¦ã‚‰ãªã„
      let escaped = '';
      for (let c of s) {
        if (Math.random() < 0.7) {
          escaped += '\\x' + c.charCodeAt(0).toString(16).padStart(2,'0');
        } else {
          escaped += '\\u' + c.charCodeAt(0).toString(16).padStart(4,'0');
        }
      }
      // æœ€å¼·ã®å¾©å…ƒæ–¹æ³•ï¼šString.fromCharCodeã‚’ä½¿ã‚ãšã€+""ã§å¾©å…ƒ
      return `("${escaped}"+"")`;
    });
  }

  // 4. ãƒ‡ãƒƒãƒ‰ã‚³ãƒ¼ãƒ‰ï¼ˆå®‰å…¨ãªã‚„ã¤ã ã‘ï¼‰
  if (document.getElementById('deadCode').checked) {
    const amt = document.getElementById('deadAmount').value * 10;
    let junk = '';
    for (let i = 0; i < amt; i++) {
      const v = `_0x${Math.random().toString(36).slice(2,8)}`;
      junk += `var ${v}=${i};${v}=${v}>>0;`;
    }
    result = junk + result;
  }

  // 5. evalã§å®Œå…¨åŒ…å›²ï¼ˆã‚¯ã‚©ãƒ¼ãƒˆã¯æœ€å¾Œã«ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ï¼‰
  if (document.getElementById('wrapEval').checked) {
    // eval("...") ã®å½¢ã«ã™ã‚‹ã€‚ãƒ€ãƒ–ãƒ«ã‚¯ã‚©ãƒ¼ãƒˆã¯\\ã§ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—
    let escaped = result
      .replace(/\\/g, '\\\\')
      .replace(/"/g, '\\"')
      .replace(/\n/g, '\\n')
      .replace(/\r/g, '\\r');
    result = `eval("${escaped}")`;
  }

  return result;
}

function obfuscateMulti() {
  let code = document.getElementById('input').value.trim();
  if (!code) return alert('ã‚³ãƒ¼ãƒ‰ãŒãªã„ã¨äººé¡ã¯å®ˆã‚Œãªã„');

  const layers = parseInt(document.getElementById('layers').value);

  for (let i = 0; i < layers; i++) {
    code = obfuscateOnce(code);
  }

  finalCode = code;
  document.getElementById('output').textContent = finalCode;
  document.getElementById('testResult').textContent = "æº–å‚™OK";
  document.getElementById('testResult').style.color = "#0f0";
}

function testRun() {
  if (!finalCode) return alert('å…ˆã«é›£èª­åŒ–ã—ã‚ï¼');

  try {
    new Function(finalCode)();
    document.getElementById('testResult').textContent = "âœ… å®Œç’§ã«å‹•ã„ãŸï¼Hello Worldè¡¨ç¤ºã•ã‚ŒãŸï¼ï¼";
    document.getElementById('testResult').style.color = "#0f0";
  } catch (e) {
    document.getElementById('testResult').textContent = "âŒ å¤±æ•—: " + e.message;
    document.getElementById('testResult').style.color = "#f00";
    console.error(e);
  }
}

function copy() {
  navigator.clipboard.writeText(finalCode);
  alert('ã‚³ãƒ”ãƒ¼å®Œäº†ã€‚ã“ã‚Œã§å›ã®ã‚³ãƒ¼ãƒ‰ã¯æ°¸é ã«å®ˆã‚‰ã‚Œã‚‹â€¦');
}

// ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼æ›´æ–°
document.getElementById('layers').addEventListener('input', e => document.getElementById('layerVal').textContent = e.target.value);
document.getElementById('deadAmount').addEventListener('input', e => document.getElementById('deadVal').textContent = e.target.value);
</script>
</body>
</html>
