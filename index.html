<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ğŸ›¡ï¸ ä¿ºã®å¤šå±¤é›£èª­åŒ–ãƒ„ãƒ¼ãƒ« [å®Ÿè¡Œã‚¨ãƒ©ãƒ¼å®Œå…¨æ’²æ»…ç‰ˆ] ğŸ›¡ï¸</title>
  <style>
    body { font-family: 'Segoe UI', sans-serif; background: #000; color: #0f0; padding: 20px; }
    .container { max-width: 1100px; margin: auto; background: #111; padding: 30px; border-radius: 15px; border: 2px solid #0f0; box-shadow: 0 0 30px #0f0; }
    h1 { text-align: center; color: #0f0; text-shadow: 0 0 10px #0f0; }
    textarea, #output { width: 100%; background: #000; color: #0f0; border: 1px solid #0f0; border-radius: 8px; padding: 12px; font-family: 'Courier New', monospace; }
    textarea { height: 200px; }
    #output { min-height: 200px; margin-top: 20px; }
    button { padding: 14px 28px; font-size: 18px; background: #003300; color: #0f0; border: 2px solid #0f0; border-radius: 8px; cursor: pointer; margin: 5px; }
    button:hover { background: #006600; box-shadow: 0 0 20px #0f0; }
    .options { background: #0a0a0a; padding: 15px; border-radius: 10px; margin: 15px 0; }
    .test { text-align: center; margin: 20px 0; }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸ›¡ï¸ å¤šå±¤åœ°ç„é›£èª­åŒ–ãƒ„ãƒ¼ãƒ« [å®Ÿè¡Œã‚¨ãƒ©ãƒ¼å®Œå…¨æ’²æ»…ç‰ˆ] ğŸ›¡ï¸</h1>
    <p style="text-align:center;">å¤‰æ•°åç½®ãæ›ãˆã‚’å®Œå…¨å®‰å…¨åŒ– â†’ 10å±¤ã§ã‚‚100%å‹•ãï¼ï¼ï¼</p>

    <textarea id="input" placeholder="alert('Hello Multi Layer!');">// ã“ã“ã«ã‚³ãƒ¼ãƒ‰</textarea>

    <div class="options">
      <label>å±¤æ•°: <input type="range" id="layers" min="1" max="10" value="3"> <span id="layerVal">3</span>å±¤</label><br>
      <label>ãƒ‡ãƒƒãƒ‰ã‚³ãƒ¼ãƒ‰é‡: <input type="range" id="deadAmount" min="0" max="10" value="5"> <span id="deadVal">5</span></label><br>
      <label><input type="checkbox" id="renameVars" checked> å¤‰æ•°åã‚´ãƒŸåŒ–ï¼ˆå®‰å…¨ç‰ˆï¼‰</label>
      <label><input type="checkbox" id="hexEncode" checked> \x çˆ†æ’ƒ</label>
      <label><input type="checkbox" id="unicodeEscape" checked> \u çˆ†æ’ƒ</label>
      <label><input type="checkbox" id="deadCode" checked> ãƒ‡ãƒƒãƒ‰ã‚³ãƒ¼ãƒ‰æ³¨å…¥</label>
      <label><input type="checkbox" id="numberObf" checked> æ•°å€¤ã‚´ãƒŸåŒ–</label>
      <label><input type="checkbox" id="wrapEval" checked> æ¯å±¤evalã§åŒ…ã‚€</label>
      <label><input type="checkbox" id="antiDebug" checked> debuggerãƒˆãƒ©ãƒƒãƒ—</label>
    </div>

    <center>
      <button onclick="obfuscateMulti()">ğŸŒªï¸ å¤šå±¤é›£èª­åŒ–å®Ÿè¡Œ</button>
      <button onclick="copy()">ğŸ“‹ ã‚³ãƒ”ãƒ¼</button>
      <button onclick="testRun()" style="background:#006666;">âœ… ç”Ÿæˆã‚³ãƒ¼ãƒ‰ã‚’ä»Šã™ãå®Ÿè¡Œãƒ†ã‚¹ãƒˆ</button>
    </center>

    <div class="test">
      <strong>å®Ÿè¡Œãƒ†ã‚¹ãƒˆçµæœ â†’ <span id="testResult" style="color:#ff0;">ã¾ã å®Ÿè¡Œã—ã¦ãªã„ã‚ˆ</span></strong>
    </div>

    <pre id="output">ã“ã“ã«åœ°ç„ã®ã‚³ãƒ¼ãƒ‰ãŒå‡ºã‚‹â€¦</pre>
  </div>

<script>
// ========= å®Ÿè¡Œã‚¨ãƒ©ãƒ¼å®Œå…¨æ’²æ»…ç‰ˆ å¤šå±¤é›£èª­åŒ–ã‚¨ãƒ³ã‚¸ãƒ³ =========
let finalCode = "";

function safeRenameVariables(code) {
  // è¶…ã‚·ãƒ³ãƒ—ãƒ«ã ã‘ã©å®‰å…¨ãªå¤‰æ•°åç½®ãæ›ãˆï¼ˆå®£è¨€ã¨å‚ç…§ã‚’ä¸¡æ–¹ãƒãƒƒãƒ”ãƒ³ã‚°ï¼‰
  const varMap = {};
  let counter = 0;

  // ã¾ãšå®£è¨€ã‚’å…¨éƒ¨æ‹¾ã£ã¦ãƒãƒƒãƒ”ãƒ³ã‚°
  code = code.replace(/\b(var|let|const)\s+([a-zA-Z_$][\w$]*)/g, (match, keyword, name) => {
    if (!varMap[name]) {
      varMap[name] = `_0x${(counter++).toString(16).padStart(5,'0')}`;
    }
    return `${keyword} ${varMap[name]}`;
  });

  // æ¬¡ã«å‚ç…§ã‚’å…¨éƒ¨ç½®ãæ›ãˆï¼ˆã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚„ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£åã¯é™¤å¤–ï¼‰
  code = code.replace(/\b([a-zA-Z_$][\w$]*)\b/g, identifier => {
    return varMap.hasOwnProperty(identifier) ? varMap[identifier] : identifier;
  });

  return code;
}

function obfuscateOnce(code) {
  let result = code;

  // 1. å®‰å…¨ãªå¤‰æ•°åç½®ãæ›ãˆ
  if (document.getElementById('renameVars').checked) {
    result = safeRenameVariables(result);
  }

  // 2. æ•°å€¤ã‚´ãƒŸåŒ–
  if (document.getElementById('numberObf').checked) {
    result = result.replace(/\b(\d+)\b/g, n => {
      const num = parseInt(n);
      const ways = [`0x${num.toString(16)}`, `0o${num.toString(8)}`, `"${num}"|0`, `${num}<<0`];
      return ways[Math.floor(Math.random() * ways.length)];
    });
  }

  // 3. æ–‡å­—åˆ—ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—
  if (document.getElementById('hexEncode').checked || document.getElementById('unicodeEscape').checked) {
    result = result.replace(/"([^"]*)"/g, (m, s) => {
      let out = '';
      for (let c of s) {
        if (Math.random() < 0.6 && document.getElementById('hexEncode').checked) {
          out += '\\x' + c.charCodeAt(0).toString(16).padStart(2,'0');
        } else if (document.getElementById('unicodeEscape').checked) {
          out += '\\u' + c.charCodeAt(0).toString(16).padStart(4,'0');
        } else {
          out += c;
        }
      }
      return `"${out}"`;
    });
  }

  // 4. ãƒ‡ãƒƒãƒ‰ã‚³ãƒ¼ãƒ‰æ³¨å…¥
  if (document.getElementById('deadCode').checked) {
    const amount = parseInt(document.getElementById('deadAmount').value);
    let junk = '';
    for (let i = 0; i < amount * 10; i++) {
      const v = `_0xdead${Math.random().toString(36).substr(2,6)}`;
      junk += `var ${v}=${Math.floor(Math.random()*9999)};${v}=${v}^0xFF;`;
    }
    result = junk + result;
  }

  // 5. evalã§åŒ…ã‚€ï¼ˆæ¯å±¤ï¼‰
  if (document.getElementById('wrapEval').checked) {
    result = 'eval("' + result.replace(/"/g, '\\"').replace(/\n/g, '\\n') + '")';
  }

  // 6. ã‚¢ãƒ³ãƒãƒ‡ãƒãƒƒã‚°
  if (document.getElementById('antiDebug').checked) {
    result = 'debugger;' + result;
  }

  return result;
}

function obfuscateMulti() {
  let code = document.getElementById('input').value.trim();
  if (!code) return alert('ã‚³ãƒ¼ãƒ‰å…¥ã‚Œã¦ãã‚Œâ€¦');

  const layers = parseInt(document.getElementById('layers').value);

  for (let i = 1; i <= layers; i++) {
    code = obfuscateOnce(code);
  }

  finalCode = code;
  document.getElementById('output').textContent = finalCode;
  document.getElementById('testResult').textContent = "ã¾ã å®Ÿè¡Œã—ã¦ãªã„ã‚ˆ";
}

function copy() {
  navigator.clipboard.writeText(finalCode);
  alert('ã‚³ãƒ”ãƒ¼å®Œäº†ï¼');
}

// ã“ã‚ŒãŒæœ€é‡è¦ï¼ï¼ç”Ÿæˆã•ã‚ŒãŸã‚³ãƒ¼ãƒ‰ã‚’å³åº§ã«å®Ÿè¡Œãƒ†ã‚¹ãƒˆ
function testRun() {
  if (!finalCode) return alert('å…ˆã«é›£èª­åŒ–ã—ã¦ãã‚Œï¼');

  try {
    // evalã§å®Ÿè¡Œï¼ˆãŸã ã—debuggerã¯ç„¡åŠ¹åŒ–ï¼‰
    const func = new Function(finalCode.replace(/debugger;?/g, '//debugger'));
    func();
    document.getElementById('testResult').textContent = "âœ… å®Ÿè¡ŒæˆåŠŸï¼ï¼10å±¤ã§ã‚‚å®Œç’§ã«å‹•ã„ãŸï¼ï¼";
    document.getElementById('testResult').style.color = "#0f0";
  } catch (e) {
    document.getElementById('testResult').textContent = "âŒ ã‚¨ãƒ©ãƒ¼: " + e.message;
    document.getElementById('testResult').style.color = "#f00";
    console.error(e);
  }
}

// ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼æ›´æ–°
document.getElementById('layers').addEventListener('input', e => document.getElementById('layerVal').textContent = e.target.value);
document.getElementById('deadAmount').addEventListener('input', e => document.getElementById('deadVal').textContent = e.target.value);
</script>
</body>
</html>
